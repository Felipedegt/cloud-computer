FROM node:10.16.0-alpine
WORKDIR /app

RUN npm config set unsafe-perm true

ARG REACT_APP
ENV REACT_APP=$REACT_APP

ARG REACT_APP_HOST
ENV REACT_APP_HOST=$REACT_APP_HOST

ARG REACT_APP_WEBSOCKET_HOST
ENV REACT_APP_WEBSOCKET_HOST=$REACT_APP_WEBSOCKET_HOST

ARG AUTH_SERVICE_HOST
ENV AUTH_SERVICE_HOST=$AUTH_SERVICE_HOST

ARG STREAM_HOST
ENV STREAM_HOST=$STREAM_HOST

ARG GOOGLE_CALLBACK
ENV GOOGLE_CALLBACK=$GOOGLE_CALLBACK

ARG GOOGLE_REDIRECT
ENV GOOGLE_REDIRECT=$GOOGLE_REDIRECT

ARG GITHUB_CALLBACK
ENV GITHUB_CALLBACK=$GITHUB_CALLBACK

ARG GITHUB_REDIRECT
ENV GITHUB_REDIRECT=$GITHUB_REDIRECT

COPY package.json package.json
RUN yarn --pure-lockfile

COPY . .

# Building app
# RUN npm run build

CMD yarn dev
